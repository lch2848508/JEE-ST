var userAgentStr=navigator.userAgent.toLowerCase();function isIE(){var a=/(msie\s|trident.*rv:)([\w.]+)/;return a.exec(userAgentStr)!=null;}function isFirefor(){var a=/(firefox)\/([\w.]+)/;return a.exec(userAgentStr)!=null;}function isChrome(){return/chrome\/(\d+\.\d)/i.test(userAgentStr);}var StringUtils={};StringUtils.before=function(c,a){var b=c.indexOf(a);if(b==-1){return"";}else{return c.substr(0,b);}};StringUtils.after=function(c,a){var b=c.indexOf(a);if(b==-1){return"";}else{return c.substr(b+a.length);}};StringUtils.between=function(a,c,b){var d=StringUtils.after(a,c);d=StringUtils.before(d,b);return d;};StringUtils.lTrim=function(a){return a.replace(/(^\s*)/g,"");};StringUtils.rTrim=function(a){return a.replace(/(\s*$)/g,"");};StringUtils.trim=function(a){return a.replace(/(^\s*)|(\s*$)/g,"");};StringUtils.replaceAll=function(c,a,b){if(StringUtils.isEmpty(c)){return"";}return c.split(a).join(b);};StringUtils.isEmpty=function(a){if(typeof(a)=="number"){return false;}return(a==undefined||a==null||a==="");};StringUtils.escapeHtml=function(a){return encodeHtml(a);};var REGX_HTML_ENCODE=/"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g;function encodeHtml(a){return(typeof a!="string")?a:a.replace(REGX_HTML_ENCODE,function(b){var e=b.charCodeAt(0),d=["&#"];e=(e==32)?160:e;d.push(e);d.push(";");return d.join("");});}var ARRAY={};ARRAY.indexOf=function(a,b){return $.inArray(b,a);};var FILEUTILS={};FILEUTILS.includeJs=include_js;FILEUTILS.includeCss=include_css;function include_js(c){var b=document.createElement("script");b.type="text/javascript";b.src=c;var a=document.getElementsByTagName("head")[0];a.appendChild(b);}function include_css(c){var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=c;var a=document.getElementsByTagName("head")[0];a.appendChild(b);}var Convert={};Convert.try2Int=function(d,b){if(b==undefined){b=0;}var a=b;try{a=parseInt(d);if(isNaN(a)){a=b;}}catch(c){}return a;};Convert.try2Number=function(d,b){if(b==undefined){b=0;}var a=b;try{a=parseFloat(d);if(isNaN(a)){a=b;}}catch(c){}return a;};Convert.try2Date=function(f,b){var a=b;var c=f.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(c!=null){var e=new Date(c[1],c[3]-1,c[4]);if(e.getFullYear()==c[1]&&(e.getMonth()+1)==c[3]&&e.getDate()==c[4]){a=e;}}return a;};var DateUtils={};DateUtils.addDay=function(c,b){var a=new Date();a.setTime(c.getTime()+b*24*3600*1000);return a;};DateUtils.addHour=function(c,b){var a=new Date();a.setTime(c.getTime()+b*3600*1000);return a;};DateUtils.addMinute=function(b,c){var a=new Date();a.setTime(b.getTime()+c*60*1000);return a;};DateUtils.addSecond=function(c,b){var a=new Date();a.setTime(c.getTime()+b*1000);return a;};DateUtils.toDate=function(h){var b=null;var f=h.split(" ");var d=f[0].split("-");var i=parseInt(d[0],10);var g=parseInt(d[1],10)-1;var j=parseInt(d[2],10);if(f.length==2){var k=f[1].split("-");var e=parseInt(k[0],10);var c=parseInt(k[1],10)-1;var a=parseInt(k[2],10);b=new Date(i,g,j,e,c,a);}else{b=new Date(i,g,j);}return b;};DateUtils.compare=function(b,a){return b.getTime()-a.getTime();};DateUtils.today=function(){return new Date();};DateUtils.todayStr=function(){return DateUtils.toString(new Date(),false);};DateUtils.toString=function(d,a){var b="-";var g=d.getFullYear();var f=d.getMonth()+1;var i=d.getDate();if(f<10){f="0"+f;}if(i<10){i="0"+i;}var j=g+b+f+b+i;if(a){j+=" ";b=":";var e=d.getHours();j+=(e<10?"0"+e:e)+b;var c=d.getMinutes();j+=(c<10?"0"+c:c)+b;var k=d.getSeconds();j+=(k<10?"0"+k:k);}return j;};function getClipboard(){if(window.clipboardData){return(window.clipboardData.getData("Text"));}else{if(window.netscape){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return;}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return;}c.addDataFlavor("text/unicode");d.getData(c,d.kGlobalClipboard);var e=new Object();var a=new Object();try{c.getTransferData("text/unicode",e,a);
}catch(b){return null;}if(e){if(Components.interfaces.nsISupportsWString){e=e.value.QueryInterface(Components.interfaces.nsISupportsWString);}else{if(Components.interfaces.nsISupportsString){e=e.value.QueryInterface(Components.interfaces.nsISupportsString);}else{e=null;}}}if(e){return(e.data.substring(0,a.value/2));}}}return null;}function copyToClipboard(b){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",b);}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.location=b;}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(g){alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'");}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return;}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return;}c.addDataFlavor("text/unicode");var h=new Object();var a=new Object();var h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var i=b;h.data=i;c.setTransferData("text/unicode",h,i.length*2);var f=Components.interfaces.nsIClipboard;if(!d){return false;}d.setData(c,null,f.kGlobalClipboard);}}}}function fixFlexArray(c){var a=[];for(var b in c){a[b*1]=c[b];}return a;}function getBirthday(d){var a,b;if(d.length==18){a=d.substring(6,14);}else{if(d.length==15){b=d.substring(6,12);a="19"+b;}else{return"";}}var c=a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8);return c;}function getSex(d){var b,c;if(d.length==18){b=d.substring(16,17);}else{if(d.length==15){b=d.substring(14,15);}else{return"";}}var a=b%2;if(a==0){c="女";}else{c="男";}return c;}function isBrowseScale(){var c=0,a=window.screen,b=navigator.userAgent.toLowerCase();if(isFirefor()){if(window.devicePixelRatio!==undefined){c=window.devicePixelRatio;}}else{if(isIE()){if(a.deviceXDPI&&a.logicalXDPI){c=a.deviceXDPI/a.logicalXDPI;}}else{if(window.outerWidth!==undefined&&window.innerWidth!==undefined){c=window.outerWidth/window.innerWidth;}}}if(c){c=Math.round(c*100);}if(c!==100){if(c>=98&&c<=102){c=100;}}return c!=100;}function openWindow(a,b){var d=window.open("",a);var c=d.document;c.write(b);c.close();}function flashChecker(){var a=0;var b=0;if(isIE()){var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(d){a=1;VSwf=d.GetVariable("$version");b=parseInt(VSwf.split(" ")[1].split(",")[0]);}}else{if(navigator.plugins&&navigator.plugins.length>0){var d=navigator.plugins["Shockwave Flash"];if(d){a=1;var e=d.description.split(" ");for(var c=0;c<e.length;++c){if(isNaN(parseInt(e[c]))){continue;}b=parseInt(e[c]);}}}}return{f:a,v:b};}function favorite_home(){var a=window.location.href;a=a.substr(0,a.lastIndexOf("/"));a=a.substr(0,a.lastIndexOf("/"));a=a+"/index.jsp";window.external.addFavorite(a,VAR_DOCUMENT_TITLE);}var FORM={};FORM.isReadonly=function(){return top.MainFormFlash.Callback_Form_IsReadonly(__formids__);};FORM.PARAMS={};FORM.PARAMS.getAll=function(){return top.INTF_FORM.PARAMS.getParams(__formids__);};FORM.PARAMS.get=function(a){var b=FORM.PARAMS.getAll();return b?b[a]:null;};FORM.initParams=function(a){return top.INTF_FORM.getInstance(__formids__).initParams(a);};FORM.isCallByPortal=function(){return Convert.try2Int(FORM.PARAMS.get("IS_PORTAL_FORM"),0)==1;};FORM.isPortal=FORM.isCallByPortal;FORM.close=function(){return top.INTF_FORM.close(__formids__);};FORM.DB={};FORM.DB.isNew=function(){return top.INTF_FORM.DATASET.isNew(__formids__);};FORM.DB.existsRecord=function(a){return top.INTF_FORM.DATASET.existsRecord(__formids__,a);};FORM.DB.existsDataSet=function(a){return top.INTF_FORM.DATASET.existsDataSet(__formids__,a);};FORM.DB.getServerUniqueId=function(){return top.GLOBAL.DB.getServerUniqueid();};FORM.DB.getSerialCode=function(a){return top.GLOBAL.DB.getSerialCode(a);};FORM.DB.getServerDate=function(a){return top.GLOBAL.DB.getServerDate(a);};FORM.DB.getDataSetValue=function(a,b){return top.INTF_FORM.DATASET.getValue(__formids__,a,b);
};FORM.DB.setDataSetValue=function(a,c,b){return top.INTF_FORM.DATASET.setValue(__formids__,a,c,b);};FORM.DB.setDataSetValues=function(a,b){return top.INTF_FORM.DATASET.setValues(__formids__,a,b);};FORM.DB.getDataSetRecords=function(b){var d=top.INTF_FORM.DATASET.getDatas(__formids__,b);var a=[];for(var c in d){a[c*1]=d[c];}return a;};FORM.DB.appendRecords=function(a,b){return top.INTF_FORM.DATASET.appendRecords(__formids__,a,b);};FORM.DB.executeDataSet=function(b,c,a){return top.INTF_FORM.DATASET.execute(__formids__,b,c,a);};FORM.DB.batchExecuteDataSet=function(b,c,a){return top.INTF_FORM.DATASET.batchExecute(__formids__,b,c,a);};FORM.DB.lookupDataSet=function(f,g,e,b,c,a,d){if(typeof(e)=="function"){window.__gridDataSetCallbackFunction__=e;e="__gridDataSetCallbackFunction__";}top.GLOBAL.DB.gridDataSet(-1,f,g,e,b,c,a,d,__formids__);};FORM.DB.treeDataSet=function(c,g,e,b,j,d,f,a,i,h){if(typeof(e)=="function"){window.__treeDataSetCallbackFunction__=e;e="__treeDataSetCallbackFunction__";}return top.GLOBAL.DB.treeDataSet(-1,c,g,e,b,j,d,__formids__,f,a,{datasetName:c,selectedValues:i,portalId:-1},h);};FORM.DB.listDataSet=FORM.DB.lookupDataSet;FORM.DB.getDataSetJson=function(a,b){return top.GLOBAL.DB.getLookupDatasetJson(-1,a,b);};FORM.DB.refreshDataSets=function(a){return top.INTF_FORM.DB.refresh(__formids__,a);};FORM.DB.batchSetDataSetValues=function(c,b,a){return top.INTF_FORM.DB.batchSetValues(__formids__,c,b,a);};FORM.DB.save=function(){return top.INTF_FORM.DATASET.save(__formids__);};FORM.DB.copyFrom=function(b,a){return top.INTF_FORM.DATASET.copyFrom(__formids__,b,a);};FORM.DB.updateDataSetValues=function(b,a){return top.INTF_FORM.DATASET.updateDataSetValues(__formids__,b,a);};FORM.DB.clearRecords=function(a){return top.INTF_FORM.DATASET.clearRecords(__formids__,a);};FORM.DB.deleteRecord=function(a){return top.INTF_FORM.DATASET.deleteRecord(__formids__,a);};FORM.DB.deleteRecords=function(b,a){return top.INTF_FORM.DATASET.deleteRecords(__formids__,b,a);};FORM.CONTROL={};FORM.CONTROL.getControlValue=function(a){return top.INTF_FORM.CONTROL.getValue(__formids__,a);};FORM.CONTROL.getControlValueEx=function(a){return top.INTF_FORM.CONTROL.getValueEx(__formids__,a);};FORM.CONTROL.setControlValue=function(c,b,a){return top.INTF_FORM.CONTROL.setValue(__formids__,c,b,a);};FORM.CONTROL.get=function(a){return top.INTF_FORM.CONTROL.get(__formids__,a);};FORM.CONTROL.getDBGridSelectedItem=function(a){return top.INTF_FORM.CONTROL.getGridSelectedItem(__formids__,a);};FORM.CONTROL.selectGridItem=function(a,b,c){return top.INTF_FORM.CONTROL.selectDBGridByKeyField(__formids__,a,b,c);};FORM.CONTROL.setControlsEnabled=function(b,a){return top.INTF_FORM.CONTROL.setControlsEnabled(__formids__,b,a);};FORM.CONTROL.setControlsVisible=function(a,b){return top.INTF_FORM.CONTROL.setControlsVisible(__formids__,a,b);};FORM.CONTROL.setGridBehaviour=function(c,b,a){return top.INTF_FORM.CONTROL.setGridBehaviour(__formids__,c,b,a);};FORM.CONTROL.clearComboboxItems=function(a){return top.INTF_FORM.CONTROL.clearComboboxItems(__formids__,a);};FORM.CONTROL.setPageControlActivePage=function(a,b){return top.INTF_FORM.CONTROL.setTabSheetActivePage(__formids__,a,b);};FORM.EVENT={};FORM.EVENT.registerEvent=registerEventFunction;FORM.WINDOW={};FORM.WINDOW.changeWindowURL=function(a){};FORM.WINDOW.showCommonURL=function(a){};FORM.WINDOW.goURL=function(a){top.GLOBAL.UTILS.OpenURL(a);};FORM.WINDOW.getDialogInitDatas=function(){return null;};FORM.WINDOW.listDataSet=FORM.DB.listDataSet;FORM.WINDOW.lookupDataSet=FORM.DB.lookupDataSet;FORM.WINDOW.getDataSetJson=FORM.DB.getDataSetJson;FORM.WINDOW.modalDialog=function(d,c,b,g,f,a,h){var e=top.getFomrsSize(d);if(typeof(f)=="function"){window.__modalDialogCallbackFunction__=f;f="__modalDialogCallbackFunction__";}if(typeof(a)=="function"){window.__modalDialogCloseCallbackFunction__=a;a="__modalDialogCloseCallbackFunction__";}if((typeof a)=="boolean"){h=a;a="";}top.GLOBAL.WIN.modalDialog(d,e.w,e.h,c,b,g,f,a,__formids__,h);};FORM.CONST={};FORM.CONST.ZERO=0;FORM.CONST.ONE=1;FORM.CONST.TWO=2;FORM.CONST.THREE=3;FORM.CONST.SQL_SELECT=0;
FORM.CONST.SQL_INSERT=1;FORM.CONST.SQL_UPDATE=2;FORM.CONST.SQL_DELETE=3;function registerEventFunction(d,c,b,a){if(!registerEventFunction.events){registerEventFunction.events=[];}registerEventFunction.events.push({controlType:d,controlId:c,eventType:b,eventName:a});}function triggerEventFunction(a,g,b,c){var j=true;if(!registerEventFunction.events){return true;}for(var d=0;d<registerEventFunction.events.length;d++){var h=registerEventFunction.events[d];if(b==h.eventType&&(!g||g==h.controlId)&&(!a||h.controlType==a)){var e=window[h.eventName];if(e&&typeof(e)=="function"){var f=!c?e():e(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9]);if(f==undefined){f=true;}if(!f){j=false;}}}}return j;}function triggerEventFunctionFromAs(a){return triggerEventFunction(a.controlType,a.controlId,a.eventType,a.params);}function __TRIGGER_CONTROL_EVENT__(c){var b=c.funName;var a=c.controlId;if(window[b]){window[b](a);}}var GLOBAL={};GLOBAL.flexConfirm=function(c,b,a){if(!a){a="";}if(typeof(b)=="function"){window.__flexConfirmCallbackFunction__=b;b="__flexConfirmCallbackFunction__";}if(typeof(a)=="function"){window.__flexConfirmCallbackCancelFunction__=a;a="__flexConfirmCallbackCancelFunction__";}top.GLOBAL.UTILS.flexConfirm(c,b,a,__formids__);};GLOBAL.moduleSWFDialog=function(b,d,a,c,f,e){if(typeof(e)=="function"){window.__flexModuleSWFDialogCallbackFunction__=e;e="__flexModuleSWFDialogCallbackFunction__";}top.GLOBAL.WIN.moduleSWFDialog(b,d,a,c,f,__formids__,e);};GLOBAL.commonWords=function(b,c,a){if(typeof(c)=="function"){window.__flexModuleCOMMONWordsFunction__=c;c="__flexModuleCOMMONWordsFunction__";}return top.GLOBAL.commonWords(b,__formids__,c,a);};var OPUTILS={};OPUTILS.sendMsm=function(a,b){return top.GLOBAL.UTILS.sendMobileMessage(a,b);};OPUTILS.sendEmail=function(a,b,c){return top.GLOBAL.UTILS.sendEmail(a,b,c);};function executeOtherCallmeFunction(){var f=top.getCallPortalFunctionParams(__formids__);if(f){var a=f[0].split(".");var d=f[1];var b=window;for(var c=0;c<a.length;c++){var e=a[c];var b=b[e];}if(typeof(b)=="function"){return b(d);}else{return b;}}}function downAttachment(paramsStr){eval("url = "+paramsStr);GLOBAL.goURL("/attachment/"+url);}var WEBGIS={};WEBGIS.winMap=function(a,c,b,f,e){var d="Map4MIS.swf";GLOBAL.moduleSWFDialog(a,1000,600,d,{mapName:c,initFunction:b,initParams:f,userId:GLOBAL.USERINFO.id},e);};WEBGIS.selectMapFeature=function(b,a,c){WEBGIS.winMap("选取地图实体",b,"showFeature",a,c);};GLOBAL.flexAlert=top.GLOBAL.UTILS.flexAlert;GLOBAL.OpenURL=top.GLOBAL.UTILS.OpenURL;GLOBAL.goURL=top.GLOBAL.UTILS.OpenURL;GLOBAL.USERINFO={id:top.INTF_ENVIRONMENT.USERID,name:top.INTF_ENVIRONMENT.REALNAME};GLOBAL.INTF_ENVIRONMENT=top.INTF_ENVIRONMENT;GLOBAL.WINDOW=FORM.WINDOW;GLOBAL.PRINT=top.GLOBAL.PRINT;GLOBAL.gotoPortal=top.GLOBAL.gotoPortal;GLOBAL.executePortalFunction=top.GLOBAL.executePortalFunction;GLOBAL.STORAGE=top.GLOBAL.STORAGE;GLOBAL.UTILS=top.GLOBAL.UTILS;GLOBAL.popupMessage=top.GLOBAL.popupMessage;dynamicCreateWorkFlowProcess=top.dynamicCreateWorkFlowProcess;DHTML4FLEX=top.DHTML4FLEX;EXTINTF={};function documentOnLoad(){triggerEventFunction("form",null,"OnInitialize",[]);executeOtherCallmeFunction();}