var userAgentStr=navigator.userAgent.toLowerCase();function isIE(){var a=/(msie\s|trident.*rv:)([\w.]+)/;return a.exec(userAgentStr)!=null;}function isFirefor(){var a=/(firefox)\/([\w.]+)/;return a.exec(userAgentStr)!=null;}function isChrome(){return/chrome\/(\d+\.\d)/i.test(userAgentStr);}var StringUtils={};StringUtils.before=function(c,a){var b=c.indexOf(a);if(b==-1){return"";}else{return c.substr(0,b);}};StringUtils.after=function(c,a){var b=c.indexOf(a);if(b==-1){return"";}else{return c.substr(b+a.length);}};StringUtils.between=function(a,c,b){var d=StringUtils.after(a,c);d=StringUtils.before(d,b);return d;};StringUtils.lTrim=function(a){return a.replace(/(^\s*)/g,"");};StringUtils.rTrim=function(a){return a.replace(/(\s*$)/g,"");};StringUtils.trim=function(a){return a.replace(/(^\s*)|(\s*$)/g,"");};StringUtils.replaceAll=function(c,a,b){if(StringUtils.isEmpty(c)){return"";}return c.split(a).join(b);};StringUtils.isEmpty=function(a){if(typeof(a)=="number"){return false;}return(a==undefined||a==null||a==="");};StringUtils.escapeHtml=function(a){return encodeHtml(a);};var REGX_HTML_ENCODE=/"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g;function encodeHtml(a){return(typeof a!="string")?a:a.replace(REGX_HTML_ENCODE,function(b){var e=b.charCodeAt(0),d=["&#"];e=(e==32)?160:e;d.push(e);d.push(";");return d.join("");});}var ARRAY={};ARRAY.indexOf=function(a,b){return $.inArray(b,a);};var FILEUTILS={};FILEUTILS.includeJs=include_js;FILEUTILS.includeCss=include_css;function include_js(c){var b=document.createElement("script");b.type="text/javascript";b.src=c;var a=document.getElementsByTagName("head")[0];a.appendChild(b);}function include_css(c){var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=c;var a=document.getElementsByTagName("head")[0];a.appendChild(b);}var Convert={};Convert.try2Int=function(d,b){if(b==undefined){b=0;}var a=b;try{a=parseInt(d);if(isNaN(a)){a=b;}}catch(c){}return a;};Convert.try2Number=function(d,b){if(b==undefined){b=0;}var a=b;try{a=parseFloat(d);if(isNaN(a)){a=b;}}catch(c){}return a;};Convert.try2Date=function(f,b){var a=b;var c=f.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(c!=null){var e=new Date(c[1],c[3]-1,c[4]);if(e.getFullYear()==c[1]&&(e.getMonth()+1)==c[3]&&e.getDate()==c[4]){a=e;}}return a;};var DateUtils={};DateUtils.addDay=function(c,b){var a=new Date();a.setTime(c.getTime()+b*24*3600*1000);return a;};DateUtils.addHour=function(c,b){var a=new Date();a.setTime(c.getTime()+b*3600*1000);return a;};DateUtils.addMinute=function(b,c){var a=new Date();a.setTime(b.getTime()+c*60*1000);return a;};DateUtils.addSecond=function(c,b){var a=new Date();a.setTime(c.getTime()+b*1000);return a;};DateUtils.toDate=function(h){var b=null;var f=h.split(" ");var d=f[0].split("-");var i=parseInt(d[0],10);var g=parseInt(d[1],10)-1;var j=parseInt(d[2],10);if(f.length==2){var k=f[1].split("-");var e=parseInt(k[0],10);var c=parseInt(k[1],10)-1;var a=parseInt(k[2],10);b=new Date(i,g,j,e,c,a);}else{b=new Date(i,g,j);}return b;};DateUtils.compare=function(b,a){return b.getTime()-a.getTime();};DateUtils.today=function(){return new Date();};DateUtils.todayStr=function(){return DateUtils.toString(new Date(),false);};DateUtils.toString=function(d,a){var b="-";var g=d.getFullYear();var f=d.getMonth()+1;var i=d.getDate();if(f<10){f="0"+f;}if(i<10){i="0"+i;}var j=g+b+f+b+i;if(a){j+=" ";b=":";var e=d.getHours();j+=(e<10?"0"+e:e)+b;var c=d.getMinutes();j+=(c<10?"0"+c:c)+b;var k=d.getSeconds();j+=(k<10?"0"+k:k);}return j;};function getClipboard(){if(window.clipboardData){return(window.clipboardData.getData("Text"));}else{if(window.netscape){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return;}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return;}c.addDataFlavor("text/unicode");d.getData(c,d.kGlobalClipboard);var e=new Object();var a=new Object();try{c.getTransferData("text/unicode",e,a);
}catch(b){return null;}if(e){if(Components.interfaces.nsISupportsWString){e=e.value.QueryInterface(Components.interfaces.nsISupportsWString);}else{if(Components.interfaces.nsISupportsString){e=e.value.QueryInterface(Components.interfaces.nsISupportsString);}else{e=null;}}}if(e){return(e.data.substring(0,a.value/2));}}}return null;}function copyToClipboard(b){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",b);}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.location=b;}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(g){alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'");}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return;}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return;}c.addDataFlavor("text/unicode");var h=new Object();var a=new Object();var h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var i=b;h.data=i;c.setTransferData("text/unicode",h,i.length*2);var f=Components.interfaces.nsIClipboard;if(!d){return false;}d.setData(c,null,f.kGlobalClipboard);}}}}function fixFlexArray(c){var a=[];for(var b in c){a[b*1]=c[b];}return a;}function getBirthday(d){var a,b;if(d.length==18){a=d.substring(6,14);}else{if(d.length==15){b=d.substring(6,12);a="19"+b;}else{return"";}}var c=a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8);return c;}function getSex(d){var b,c;if(d.length==18){b=d.substring(16,17);}else{if(d.length==15){b=d.substring(14,15);}else{return"";}}var a=b%2;if(a==0){c="女";}else{c="男";}return c;}function isBrowseScale(){var c=0,a=window.screen,b=navigator.userAgent.toLowerCase();if(isFirefor()){if(window.devicePixelRatio!==undefined){c=window.devicePixelRatio;}}else{if(isIE()){if(a.deviceXDPI&&a.logicalXDPI){c=a.deviceXDPI/a.logicalXDPI;}}else{if(window.outerWidth!==undefined&&window.innerWidth!==undefined){c=window.outerWidth/window.innerWidth;}}}if(c){c=Math.round(c*100);}if(c!==100){if(c>=98&&c<=102){c=100;}}return c!=100;}function openWindow(a,b){var d=window.open("",a);var c=d.document;c.write(b);c.close();}function flashChecker(){var a=0;var b=0;if(isIE()){var d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(d){a=1;VSwf=d.GetVariable("$version");b=parseInt(VSwf.split(" ")[1].split(",")[0]);}}else{if(navigator.plugins&&navigator.plugins.length>0){var d=navigator.plugins["Shockwave Flash"];if(d){a=1;var e=d.description.split(" ");for(var c=0;c<e.length;++c){if(isNaN(parseInt(e[c]))){continue;}b=parseInt(e[c]);}}}}return{f:a,v:b};}function favorite_home(){var a=window.location.href;a=a.substr(0,a.lastIndexOf("/"));a=a.substr(0,a.lastIndexOf("/"));a=a+"/index.jsp";window.external.addFavorite(a,VAR_DOCUMENT_TITLE);}var PORTAL={};PORTAL.LAYOUT={};PORTAL.LAYOUT.A=function(){return top.INTF_PORTALGRID.LAYOUT.get(__portalid__,"a");};PORTAL.LAYOUT.B=function(){return top.INTF_PORTALGRID.LAYOUT.get(__portalid__,"b");};PORTAL.LAYOUT.C=function(){return top.INTF_PORTALGRID.LAYOUT.get(__portalid__,"c");};PORTAL.LAYOUT.Detail=function(){return top.INTF_PORTALGRID.LAYOUT.get(__portalid__,"BoxDetail");};PORTAL.LAYOUT.get=function(a){return top.INTF_PORTALGRID.LAYOUT.get(__portalid__,a);};PORTAL.GRID={};PORTAL.GRID.get=function(){return top.INTF_PORTALGRID.GRID.get(__portalid__);};PORTAL.GRID.add=function(){return top.INTF_PORTALGRID.GRID.add(__portalid__);};PORTAL.GRID.edit=function(){return top.INTF_PORTALGRID.GRID.edit(__portalid__);};PORTAL.GRID.del=function(){return top.INTF_PORTALGRID.GRID.del(__portalid__);};PORTAL.GRID.view=function(){return top.INTF_PORTALGRID.GRID.view(__portalid__);};PORTAL.GRID.up=function(){return top.INTF_PORTALGRID.GRID.up(__portalid__);};PORTAL.GRID.down=function(){return top.INTF_PORTALGRID.GRID.down(__portalid__);};PORTAL.GRID.refresh=function(){return top.INTF_PORTALGRID.GRID.refresh(__portalid__);};PORTAL.GRID.remove=function(){return top.INTF_PORTALGRID.GRID.remove(__portalid__);
};PORTAL.GRID.getSelectedItem=function(){return top.INTF_PORTALGRID.GRID.getSelectedItem(__portalid__);};PORTAL.GRID.getSelectedItems=function(){return top.INTF_PORTALGRID.GRID.getSelectedItems(__portalid__);};PORTAL.GRID.getDatas=function(){return top.INTF_PORTALGRID.GRID.getDatas(__portalid__);};PORTAL.GRID.gotoPage=function(a){return top.INTF_PORTALGRID.GRID.gotoPage(__portalid__,a);};PORTAL.GRID.setCellValue=function(b,a,d,c){if(typeof(c)=="undefined"){c=true;}top.INTF_PORTALGRID.GRID.setCellValue(b,a,d,__portalid__,c);};PORTAL.GRID.setCellsValue=function(b,a,d,c){if(typeof(c)=="undefined"){c=true;}top.INTF_PORTALGRID.GRID.setCellsValue(b,a,d,__portalid__,c);};PORTAL.GRID.selectItem=function(a){top.INTF_PORTALGRID.GRID.selectItem(a,__portalid__);};PORTAL.GRID.batchSetCellsValue=function(c,b,a){top.INTF_PORTALGRID.GRID.batchSetGridCellsValue(c,b,a,__portalid__);};PORTAL.GRID.refreshSelectItem=function(){top.INTF_PORTALGRID.GRID.refreshSelectedItem(__portalid__);};PORTAL.TREE={};PORTAL.TREE.get=function(){return top.INTF_PORTALGRID.TREE.get(__portalid__);};PORTAL.TREE.getSelectedItems=function(){return top.INTF_PORTALGRID.TREE.getSelectedItems(__portalid__);};PORTAL.TREE.getSelectItemId=function(){return PORTAL.TREE.getSelectedItems()[0].id;};PORTAL.TREE.getSelectedItem=function(){return PORTAL.TREE.getSelectedItems()[0];};PORTAL.TREE.addSibling=function(){return top.INTF_PORTALGRID.TREE.addSibling(__portalid__);};PORTAL.TREE.addChild=function(){return top.INTF_PORTALGRID.TREE.addChild(__portalid__);};PORTAL.TREE.edit=function(){return top.INTF_PORTALGRID.TREE.edit(__portalid__);};PORTAL.TREE.del=function(){return top.INTF_PORTALGRID.TREE.del(__portalid__);};PORTAL.TREE.up=function(){return top.INTF_PORTALGRID.TREE.up(__portalid__);};PORTAL.TREE.down=function(){return top.INTF_PORTALGRID.TREE.down(__portalid__);};PORTAL.TREE.refresh=function(){return top.INTF_PORTALGRID.TREE.refresh(__portalid__);};PORTAL.TREE.getDatas=function(){return top.INTF_PORTALGRID.TREE.getDatas(__portalid__);};PORTAL.TREE.getRootId=function(){return PORTAL.TREE.getDatas()[0].id;};PORTAL.DB={};PORTAL.DB.getServerUniqueId=function(){return top.GLOBAL.DB.getServerUniqueid();};PORTAL.DB.getSerialCode=function(a){return top.GLOBAL.DB.getSerialCode(a);};PORTAL.DB.getDataSetJson=function(a,b){return top.GLOBAL.DB.getLookupDatasetJson(__portalid__,a,b);};PORTAL.DB.lookupDataSet=function(f,g,e,b,c,a,d){if(typeof(e)=="function"){window.__gridDataSetCallbackFunction__=e;e="__gridDataSetCallbackFunction__";}top.GLOBAL.DB.gridDataSet(__portalid__,f,g,e,b,c,a,d,"PORTALGRID_"+__portalid__);};PORTAL.DB.executeDataSet=function(a,b){return top.GLOBAL.DB.executeSQL(__portalid__,a,b);};PORTAL.DB.batchExecuteDataSet=function(a,b){return top.GLOBAL.DB.batchExecuteSQL(__portalid__,a,b);};PORTAL.DB.treeDataSet=function(g,h,f,d,a,e,b,c){if(typeof(f)=="function"){window.__treeDataSetCallbackFunction__=f;f="__treeDataSetCallbackFunction__";}return top.GLOBAL.DB.treeDataSet(__portalid__,g,h,f,d,a,e,"PORTALGRID_"+__portalid__,"","",{datasetName:g,selectedValues:b,portalId:__portalid__},c);};PORTAL.UTILS={};PORTAL.UTILS.sendMessage=function(a,b){return top.GLOBAL.UTILS.sendMobileMessage(a,b);};PORTAL.executePortalFunction=top.GLOBAL.executePortalFunction;PORTAL.EXCEL={};PORTAL.EXCEL.downTemplate=function(d,b,a,e){if(isNaN(a)){a=0;}if(isNaN(e)){e=0;}var c={sheetName:d,header:[{row:a,startCol:e,items:b}]};top.downloadExcelTemplate(ExcelTemplateDefine);};PORTAL.EXCEL.importExcel=function(c,f,b,d,j,e,i,a){if(isNaN(i)){i=0;}if(isNaN(a)){a=0;}var h={portalID:__portalid__,execute:[{sheetName:b,datasetName:c,firstRow:i+1,firstCol:a,params2Col:j}]};var g={sheetName:b,header:[{row:i,startCol:a,items:d}]};if(typeof(e)=="function"){window.__flexUploadExcelCallbackFunction__=e;e="__flexUploadExcelCallbackFunction__";}top.uploadExcelTemplate($.toJSON(h),$.toJSON(g),f,e,"PORTALGRID_"+__portalid__);};PORTAL.EXCEL.exportExcel=function(d,g,a,c,h,e,j,b){if(isNaN(j)){j=0;}if(isNaN(b)){b=0;}var i=[];i.push({sheetName:c,datasetName:d,firstRow:j,firstCol:b,fields:h,headers:e});var f={filename:a,portalID:__portalid__,execute:i};
top.exportToExcel(f,g);};PORTAL.WINDOW={};PORTAL.WINDOW.listDataSet=PORTAL.DB.listDataSet;PORTAL.WINDOW.treeDataSet=PORTAL.DB.treeDataSet;PORTAL.WINDOW.selectDate=function(a){if(typeof(a)=="function"){window.__flexSelectedDateCallbackFunction__=a;a="__flexSelectedDateCallbackFunction__";}top.GLOBAL.UTILS.selectDate("PORTALGRID_"+__portalid__,a);};PORTAL.WINDOW.modalDialog=function(d,c,b,g,f,a,h){var e=top.getFomrsSize(d);if(typeof(f)=="function"){window.__modalDialogCallbackFunction__=f;f="__modalDialogCallbackFunction__";}if(typeof(a)=="function"){window.__modalDialogCloseCallbackFunction__=a;a="__modalDialogCloseCallbackFunction__";}top.GLOBAL.WIN.modalDialog(d,e.w,e.h,c,b,g,f,a,"PORTALGRID_"+__portalid__,h);};var GLOBAL={};GLOBAL.flexAlert=top.GLOBAL.UTILS.flexAlert;GLOBAL.flexConfirm=function(c,b,a){if(!a){a="";}if(typeof(b)=="function"){window.__flexConfirmCallbackFunction__=b;b="__flexConfirmCallbackFunction__";}if(typeof(a)=="function"){window.__flexConfirmCallbackCancelFunction__=a;a="__flexConfirmCallbackCancelFunction__";}top.GLOBAL.UTILS.flexConfirm(c,b,a,"PORTALGRID_"+__portalid__);};GLOBAL.moduleSWFDialog=function(b,d,a,c,f,e){if(typeof(e)=="function"){window.__flexModuleSWFDialogCallbackFunction__=e;e="__flexModuleSWFDialogCallbackFunction__";}top.GLOBAL.WIN.moduleSWFDialog(b,d,a,c,f,"PORTALGRID_"+__portalid__,e);};GLOBAL.OpenURL=top.GLOBAL.UTILS.OpenURL;GLOBAL.goURL=top.GLOBAL.UTILS.OpenURL;GLOBAL.USERINFO={id:top.INTF_ENVIRONMENT.USERID,name:top.INTF_ENVIRONMENT.REALNAME};GLOBAL.INTF_ENVIRONMENT=top.INTF_ENVIRONMENT;PORTAL.WINDOW.goURL=top.GLOBAL.UTILS.OpenURL;GLOBAL.WINDOW=PORTAL.WINDOW;GLOBAL.PRINT=top.GLOBAL.PRINT;GLOBAL.gotoPortal=top.GLOBAL.gotoPortal;GLOBAL.closePortal=top.GLOBAL.closePortal;GLOBAL.executePortalFunction=top.GLOBAL.executePortalFunction;GLOBAL.STORAGE=top.GLOBAL.STORAGE;GLOBAL.UTILS=top.GLOBAL.UTILS;GLOBAL.popupMessage=top.GLOBAL.popupMessage;PORTAL.TOOLBAR={};PORTAL.TOOLBAR.CONST={TREE_NEW_SIBLING:"folder_new_sibling",TREE_NEW_CHILD:"folder_new_child",TREE_DELETE:"folder_delete",TREE_EDIT:"folder_edit",TREE_MOVEUP:"folder_moveup",TREE_MOVEDOWN:"folder_movedown",GRID_NEW:"grid_new",GRID_EDIT:"grid_edit",GRID_DELETE:"grid_delete",GRID_MOVEUP:"grid_moveup",GRID_MOVEDOWN:"grid_movedown"};PORTAL.TOOLBAR.getToolbarItem=function(a){return top.INTF_PORTALGRID.TOOLBAR.getItem(a,__portalid__);};PORTAL.TOOLBAR.setToolbarItemEnabled=function(b,a){return top.INTF_PORTALGRID.TOOLBAR.setToolbarItemEnabled(b,a,__portalid__);};OPUTILS={};OPUTILS.sendMsm=function(a,b){return top.GLOBAL.UTILS.sendMobileMessage(a,b);};OPUTILS.sendEmail=function(a,b,c){return top.GLOBAL.UTILS.sendEmail(a,b,c);};function SendSMS(a,b){return top.GLOBAL.UTILS.sendMobileMessage(a,b);}function downAttachment(paramsStr){eval("url = "+paramsStr);GLOBAL.goURL("/attachment/"+url);}function executeOtherCallmeFunction(){var f=top.getCallPortalFunctionParams(getFrameID());if(f){var a=f[0].split(".");var d=f[1];var b=window;for(var c=0;c<a.length;c++){var e=a[c];var b=b[e];}if(typeof(b)=="function"){return b(d);}else{return b;}}}var dynamicCreateWorkFlowProcess=top.dynamicCreateWorkFlowProcess;var WEBGIS={};WEBGIS.winMap=function(a,c,b,f,e){var d="Map4MIS.swf";GLOBAL.moduleSWFDialog(a,1000,600,d,{mapName:c,initFunction:b,initParams:f,userId:GLOBAL.USERINFO.id},e);};WEBGIS.selectMapFeature=function(b,a,c){WEBGIS.winMap("选取地图实体",b,"showFeature",a,c);};var DHTML4FLEX=top.DHTML4FLEX;