<?xml version="1.0" encoding="utf-8"?>
<component:TitleWindowEx close="titlewindowex1_closeHandler(event)" creationComplete="titlewindowex1_creationCompleteHandler(event)" title="常用词汇" xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx"
						 xmlns:component="com.estudio.flex.component.*" width="600" height="320">
	<fx:Script>
		<![CDATA[
			import com.estudio.flex.utils.IFrameUtils;
			import com.estudio.flex.utils.JSFunUtils;

			import mx.core.FlexGlobals;
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			private static var instance:Win4CommonWord=null;

			public static function execute(items:Array, iFrameID:String, callFunname:String, initStr:String):void
			{
				if (instance == null)
					instance=new Win4CommonWord();
				instance.items=items;
				instance.callFunname=callFunname;
				instance.iFrameID=iFrameID;
				instance.initStr = initStr;
				if (instance.isCompleted)
					instance.createContent();
				PopUpManager.addPopUp(instance, FlexGlobals.topLevelApplication as DisplayObject, true);
				PopUpManager.centerPopUp(instance);
			}

			private var items:Array=null;
			private var isCompleted:Boolean=false;
			private var callFunname:String="";
			private var iFrameID:String="";
			private var initStr:String = "";

			private function createContent():void
			{
				var html:String="<textformat leftmargin='5' rightmargin='5' leading='10'><font color=\"#0000FF\">";
				for (var i:int=0; i < items.length; i++)
				{
					html+="<a href=\"event:" + items[i] + "\">" + items[i] + "</a> ";
				}
				html+="</font></textformat>";
				textArea.htmlText=html;
				textInput.text = initStr;
			}

			protected function titlewindowex1_creationCompleteHandler(event:FlexEvent):void
			{
				isCompleted=true;
				createContent();
			}

			protected function titlewindowex1_closeHandler(event:CloseEvent):void
			{
				PopUpManager.removePopUp(instance);
			}

			protected function button1_clickHandler(event:MouseEvent):void
			{
				textInput.text="";
			}

			protected function textArea_linkHandler(event:TextEvent):void
			{
				var pos:int=textInput.selectionActivePosition;
				if (pos < 0)
					pos=0;
				var bstr:String="";
				if (pos != 0)
					bstr=textInput.text.substr(0, pos);
				var astr:String=textInput.text.substr(pos, textInput.text.length - pos);
				textInput.text=bstr + event.text + astr;
				var newPos:int=pos + event.text.length;
				textInput.selectRange(newPos, newPos);
				textInput.setFocus();
			}

			protected function button2_clickHandler(event:MouseEvent):void
			{
				IFrameUtils.execute(iFrameID, callFunname, textInput.text);
				PopUpManager.removePopUp(instance);
			}
		]]>
	</fx:Script>
	<s:VGroup width="100%" height="100%" gap="0" padding="0">
		<s:HGroup width="100%" verticalAlign="middle" gap="2" padding="4">
			<s:Label text="内容:"/>
			<s:TextInput id="textInput" width="100%"/>
			<s:Button label="清除" width="70" height="25" click="button1_clickHandler(event)"/>
			<s:Button label="确定" width="70" height="25" click="button2_clickHandler(event)"/>
		</s:HGroup>

		<s:Line id="line1" width="100%" height="0">
			<s:stroke>
				<s:SolidColorStroke color="#CCCCCC"/>
			</s:stroke>
		</s:Line>

		<mx:TextArea editable="false" link="textArea_linkHandler(event)" id="textArea" width="100%" height="100%" borderVisible="false" focusThickness="0">

		</mx:TextArea>
	</s:VGroup>
</component:TitleWindowEx>
